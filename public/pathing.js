"use strict";var pathing=(()=>{var m=Object.defineProperty,A=Object.defineProperties,H=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertyNames,k=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var P=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))D.call(t,n)&&P(e,n,t[n]);if(k)for(var n of k(t))j.call(t,n)&&P(e,n,t[n]);return e},d=(e,t)=>A(e,_(t));var h=(e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})},z=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of K(t))!D.call(e,i)&&i!==n&&m(e,i,{get:()=>t[i],enumerable:!(o=H(t,i))||o.enumerable});return e};var M=e=>z(m({},"__esModule",{value:!0}),e);var Q={};h(Q,{default:()=>G,pathing:()=>E});var v={};h(v,{button:()=>f,playback:()=>g,purchase:()=>p});var c={publicKey:null,verificationError:!1};var r=class e{constructor(t,n,o){this.label=t;this.key=n;this.value=o}static unwrap(t){let n={};for(let[o,i]of Object.entries(t))n[o]=i instanceof e?i.value:i;return n}static metadata(t){let n={};for(let[o,i]of Object.entries(t))i instanceof e&&(n[o]={label:i.label,key:i.key});return n}};var I={getBrowserInfo(){return typeof window=="undefined"||typeof navigator=="undefined"?{}:{userAgent:navigator.userAgent,language:navigator.language,languages:Array.from(navigator.languages||[]),cookieEnabled:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack||navigator.doNotTrack||window.doNotTrack,vendor:navigator.vendor,platform:navigator.platform,screenWidth:window.screen.width,screenHeight:window.screen.height,screenColorDepth:window.screen.colorDepth,screenPixelDepth:window.screen.pixelDepth,innerWidth:window.innerWidth,innerHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,orientation:typeof window.screen.orientation=="object"?window.screen.orientation.type:"unknown"}},getConnectionInfo(){if(typeof navigator=="undefined"||!navigator.connection)return{};let e=navigator.connection;return{effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData}},getPerformanceInfo(){if(typeof window=="undefined"||!window.performance)return{};let e={};if(window.performance.timing){let t=window.performance.timing;e={connectEnd:t.connectEnd,connectStart:t.connectStart,domComplete:t.domComplete,domContentLoadedEventEnd:t.domContentLoadedEventEnd,domContentLoadedEventStart:t.domContentLoadedEventStart,domInteractive:t.domInteractive,domLoading:t.domLoading,domainLookupEnd:t.domainLookupEnd,domainLookupStart:t.domainLookupStart,fetchStart:t.fetchStart,loadEventEnd:t.loadEventEnd,loadEventStart:t.loadEventStart,navigationStart:t.navigationStart,redirectEnd:t.redirectEnd,redirectStart:t.redirectStart,requestStart:t.requestStart,responseEnd:t.responseEnd,responseStart:t.responseStart,unloadEventEnd:t.unloadEventEnd,unloadEventStart:t.unloadEventStart}}return{timing:e,memory:window.performance.memory?{jsHeapSizeLimit:window.performance.memory.jsHeapSizeLimit,totalJSHeapSize:window.performance.memory.totalJSHeapSize,usedJSHeapSize:window.performance.memory.usedJSHeapSize}:{}}},getGeolocation(){return new Promise(e=>{if(typeof navigator=="undefined"||!navigator.geolocation){e({});return}navigator.geolocation.getCurrentPosition(t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,altitude:t.coords.altitude,altitudeAccuracy:t.coords.altitudeAccuracy,heading:t.coords.heading,speed:t.coords.speed,timestamp:t.timestamp})},()=>{e({})},{timeout:1e3,maximumAge:6e4})})},async getAllInfo(){let e=this.getBrowserInfo(),t=this.getConnectionInfo(),n=this.getPerformanceInfo();return{browser:e,connection:t,performance:n,timestamp:Date.now(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timezoneOffset:new Date().getTimezoneOffset(),url:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname,search:window.location.search,hash:window.location.hash,isSecure:window.location.protocol==="https:",hasTouchScreen:"ontouchstart"in window||navigator.maxTouchPoints>0,browserFingerprint:q(e)}}};function q(e){let t=[e.userAgent,e.language,e.platform,e.screenWidth,e.screenHeight,e.screenColorDepth,navigator.plugins?navigator.plugins.length:0,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone].join("|");return B(t)}function B(e){let t=0;if(e.length===0)return t.toString(16);for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(16)}async function a(e,t){var i;if(!c.publicKey)return console.error(`Pathing: No API key available for tracking events. If you're using the npm package, please initialize with your API key: pathing.init('your-api-key'). If running via script tag, make sure to include pathing-api-key="pk_[YOUR_API_KEY]" in your script tag.`),{success:!1,error:"No API key provided"};if(c.verificationError)return console.warn("Pathing: Domain not verified. Tracking disabled."),{success:!1,error:"Domain not verified. Please verify your domain ownership."};let n=await I.getAllInfo(),o={type:e,payload:r.unwrap(t),metadata:r.metadata(t),deviceInfo:n,sessionInfo:{sessionId:N(),visitCount:F(),lastSeenAt:$(),firstSeenAt:W(),referrer:document.referrer||null,entryPage:V()}};try{let l=await(await fetch("https://www.pathing.dev/api/collect",{method:"POST",headers:{"Content-Type":"application/json","X-Pathing-API-Key":c.publicKey},body:JSON.stringify(o),mode:"no-cors"})).json();return!l.success&&((i=l.error)!=null&&i.includes("not verified"))&&(c.verificationError=!0,console.warn("Pathing: "+l.error)),J(),l}catch(S){return console.error("Pathing: Error tracking event",S),{success:!1,error:"Failed to track event"}}}function N(){let e="pathing_session_id",t=sessionStorage.getItem(e);return t||(t=`${Date.now()}-${Math.random().toString(36).substring(2,15)}`,sessionStorage.setItem(e,t)),t}function F(){let e="pathing_visit_count",t=parseInt(localStorage.getItem(e)||"0",10);return t+=1,localStorage.setItem(e,t.toString()),t}function $(){let t=localStorage.getItem("pathing_last_seen");return t?parseInt(t,10):null}function J(){localStorage.setItem("pathing_last_seen",Date.now().toString())}function W(){let e="pathing_first_seen",t=localStorage.getItem(e);return t||(t=Date.now().toString(),localStorage.setItem(e,t)),parseInt(t,10)}function V(){let e="pathing_entry_page",t=sessionStorage.getItem(e);return t||(t=window.location.pathname,sessionStorage.setItem(e,t)),t}function p(e){let t={product:new r("Product","product",e.product),price:new r("Price","price",e.price),currency:new r("Currency","currency",e.currency)};return e.quantity!==void 0&&(t.quantity=new r("Quantity","quantity",e.quantity)),e.extra&&Object.entries(e.extra).forEach(([n,o])=>{t[n]=o}),a("purchase",t)}function g(e){let t={contentId:new r("Content ID","content_id",e.contentId),timestamp:new r("Timestamp","timestamp",e.timestamp)};return e.duration!==void 0&&(t.duration=new r("Duration","duration",e.duration)),e.title!==void 0&&(t.title=new r("Title","title",e.title)),e.extra&&Object.entries(e.extra).forEach(([n,o])=>{t[n]=o}),a("playback",t)}function f(e){let t={buttonId:new r("Button ID","button_id",e.buttonId),location:new r("Location","location",e.location),action:new r("Action","action",e.action)};return e.buttonText!==void 0&&(t.buttonText=new r("Button Text","button_text",e.buttonText)),e.extra&&Object.entries(e.extra).forEach(([n,o])=>{t[n]=o}),a("button",t)}var b={};h(b,{button:()=>T,playback:()=>L,purchase:()=>x});function x(e,t,n={}){return e.addEventListener("click",o=>{n.preventDefault&&o.preventDefault(),p(t)}),e}function L(e,t,n={}){return e.addEventListener("click",o=>{n.preventDefault&&o.preventDefault(),g(t)}),e}function T(e,t,n={}){return e.addEventListener("click",o=>{n.preventDefault&&o.preventDefault(),!t.buttonText&&e.textContent&&(t=d(s({},t),{buttonText:e.textContent.trim()})),!t.buttonId&&e.id?t=d(s({},t),{buttonId:e.id}):t.buttonId||(t=d(s({},t),{buttonId:`btn-${e.tagName.toLowerCase()}-${Date.now()}`})),f(t)}),e}function u(e,t){return a(e,t)}function R(e,t,n,o={}){return e.addEventListener("click",i=>{o.preventDefault&&i.preventDefault(),u(t,n)}),e}function y(e){var t;if(e)c.publicKey=e;else{let n=document.querySelectorAll("script[pathing-api-key]");if(n.length>0){let o=n[0].getAttribute("pathing-api-key");o&&(c.publicKey=o)}}c.publicKey&&(a("pageview",{path:window.location.pathname,url:window.location.href,referrer:document.referrer||null,title:document.title,hostname:window.location.hostname,search:window.location.search,hash:window.location.hash,protocol:window.location.protocol,metaDescription:C("description"),metaKeywords:C("keywords"),ogTitle:w("og:title"),ogType:w("og:type"),ogUrl:w("og:url"),ogImage:w("og:image"),isNewVisit:!document.referrer||!document.referrer.includes(window.location.hostname),visitStartTime:Date.now(),characterCount:document.body?(t=document.body.textContent)==null?void 0:t.length:null,language:document.documentElement.lang}),document.addEventListener&&document.addEventListener("visibilitychange",Y),window.addEventListener("beforeunload",U))}function C(e){let t=document.querySelector(`meta[name="${e}"]`);return t?t.getAttribute("content"):null}function w(e){let t=document.querySelector(`meta[property="${e}"]`);return t?t.getAttribute("content"):null}var O=Date.now();function Y(){document.visibilityState==="hidden"?a("user_action",{action:"tab_blur",visibleDuration:Date.now()-O,path:window.location.pathname}):document.visibilityState==="visible"&&a("user_action",{action:"tab_focus",path:window.location.pathname})}function U(){a("page_exit",{path:window.location.pathname,title:document.title,duration:Date.now()-O,scrollDepth:Z()})}function Z(){if(typeof window=="undefined"||!document.documentElement)return 0;let e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight),n=document.documentElement.clientHeight||window.innerHeight;return t<=n?1:Math.min(1,e/(t-n))}var E={send:d(s({},v),{raw:u}),link:d(s({},b),{raw:R}),Parameter:r,init:y,track:(e,t)=>(console.warn("pathing.track() is deprecated. Please use pathing.send.raw() instead."),u(e,t))};typeof window!="undefined"&&(window.pathing=E,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>y()):y());var G=E;return M(Q);})();
//# sourceMappingURL=pathing.min.js.map
